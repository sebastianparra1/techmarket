<ion-header>
  <ion-toolbar class="header-toolbar">
    <ion-buttons slot="start" style="display: flex; align-items: center;">
      <ion-avatar>
        <img src="https://play-lh.googleusercontent.com/rCc1T9PFomPVLTeHgT-pIRBHco7a9UACNQOy-DQ8io-YjGXTveRm2PHqbzfhYWw6eoHI" />
      </ion-avatar>
      <div class="logo-title" style="margin-left: 10px;">
        <div style="font-weight: bold;">TechMarket</div>
        <div class="direccion-texto">üìç {{ direccion }}</div>
      </div>
    </ion-buttons>

    <ion-buttons slot="end">
      <!-- Bot√≥n de perfil ‚Üí fotoPerfil o icono default -->
      <ion-button fill="clear" id="perfil-popover" class="perfil-button">
        <img [src]="fotoPerfil || 'https://cdn-icons-png.flaticon.com/512/6073/6073873.png'" alt="Perfil"
          style="width: 7vw; max-width: 32px; min-width: 24px; height: auto; border-radius: 50%;" />
      </ion-button>

      <ion-button fill="clear" [routerLink]="['/carrito-de-compras']" class="carrito-button">
        <img src="https://cdn-icons-png.flaticon.com/512/8762/8762418.png" alt="Carrito"
          style="width: 7vw; max-width: 32px; min-width: 24px; height: auto;" />
        <ion-badge color="danger" *ngIf="carritoCount > 0" class="badge-count">{{ carritoCount }}</ion-badge>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-popover trigger="perfil-popover" triggerAction="click" showBackdrop="false">
  <ng-template>
    <ion-list>
      <!-- Mostrar fotoPerfil y nombreUsuario en el popover -->
      <ion-item lines="none" class="perfil-popover-header" style="flex-direction: column; align-items: center;">
        <ion-avatar style="margin-bottom: 10px;">
          <img [src]="fotoPerfil || 'https://via.placeholder.com/150'" />
        </ion-avatar>
        <div style="font-weight: bold;">{{ nombreUsuario }}</div>
      </ion-item>

      <ion-item button (click)="irAEditarPerfil()">Editar</ion-item>
      <ion-item button [routerLink]="['/pagina-vendedor']">Vende tus productos</ion-item>
      <ion-item button (click)="cerrarSesion()">Cerrar sesi√≥n</ion-item>
    </ion-list>
  </ng-template>
</ion-popover>

<ion-content class="ion-padding">
  <ion-card class="bienvenida-card">
    <ion-card-header>
      <ion-card-title>üëã ¬°Bienvenido, {{ nombreUsuario }}!</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      Nos alegra tenerte aqu√≠ en TechMarket. Explora nuestros productos destacados y aprovecha lo mejor en tecnolog√≠a.
    </ion-card-content>
  </ion-card>

  <div class="banner">
    <p>TechMarket es una plataforma de e-commerce que ofrece productos electr√≥nicos y perif√©ricos...</p>
    <ion-button expand="block" color="success" [routerLink]="['/productos']">
  Explorar productos
</ion-button>

  </div>

  <h2 class="section-title">Productos Destacados</h2>
  <div class="product-grid">
    <ion-card *ngFor="let producto of destacados" class="product-card">
      <img [src]="producto.imagen" alt="Producto" />
      <ion-card-header>
        <ion-card-title>{{ producto.nombre }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p><strong>Precio:</strong> ${{ producto.precio | number: '1.0-0' }}</p>
        <p *ngIf="producto.descripcion"><strong>Descripci√≥n:</strong> {{ producto.descripcion }}</p>

        <ion-button expand="block" color="success">Observar</ion-button>
        <ion-button expand="block" color="success" (click)="agregarAlCarrito(producto)">
          Agregar al carrito
        </ion-button>
        <ion-button expand="block" color="success" [routerLink]="['/chat']">Proponer intercambio</ion-button>
      </ion-card-content>
    </ion-card>
  </div>

  <h2 class="section-title">Categor√≠as</h2>
  <div class="category-row">
    <ion-chip *ngFor="let categoria of categorias" color="success" outline>{{ categoria }}</ion-chip>
  </div>

  <div class="footer-section">
    <h2 class="section-title">Para m√°s informaci√≥n :)</h2>

    <div class="footer-box">
      <h3>Sobre Nosotros</h3>
      <p>
        Somos <strong>TechMarket</strong>, una empresa que comercializa perif√©ricos...
        Escr√≠benos a <a href="mailto:Chile&#64;TechMarket.cl">Chile&#64;TechMarket.cl</a>.
      </p>
    </div>

    <div class="footer-box">
      <h3>Contacto</h3>
      <p><a href="mailto:Chile&#64;TechMarket.cl">Chile&#64;TechMarket.cl</a></p>
    </div>

    <div class="footer-box redes">
      <h3>S√≠guenos en nuestras redes sociales</h3>
      <div class="social-icons">
        <a href="https://facebook.com" target="_blank">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Facebook_Logo_%282019%29.png/1024px-Facebook_Logo_%282019%29.png" alt="Facebook" height="30" />
        </a>
        <a href="https://instagram.com" target="_blank">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/2048px-Instagram_icon.png" alt="Instagram" height="30" />
        </a>
      </div>
    </div>
  </div>
</ion-content>
