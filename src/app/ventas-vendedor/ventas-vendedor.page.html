<ion-header>
  <ion-toolbar color="success">
    <ion-title>Ventas y estado de pedidos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <ion-card color="success" style="margin-bottom: 16px;">
    <ion-card-content style="font-size: 1em; text-align: center; color: #000000;">
      <strong>Recuerda siempre avisarle a tu comprador el estado de su producto, así formaremos una mejor familia en TechMarket.</strong>
    </ion-card-content>
  </ion-card>

  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <ion-card *ngFor="let venta of ventas">
          <ion-card-header>
            <ion-card-title>{{ venta.productoNombre }}</ion-card-title>
            <ion-card-subtitle>Comprador: {{ venta.compradorNombre }} ({{ venta.compradorEmail }})</ion-card-subtitle>
          </ion-card-header>

          <ion-card-content>
            <!-- Estado actual -->
            <p>Estado actual: <strong>{{ venta.estado }}</strong></p>
            <p><strong>Cantidad comprada:</strong> {{ venta.cantidad }}</p>


            <!-- Dirección con icono -->
            <p>
              <strong>📍 Dirección:</strong>
              <a href="#" (click)="abrirEnGoogleMaps(venta.direccion)" style="text-decoration: underline; color: #1e88e5;">
                {{ venta.direccion }} 🗺️
              </a>
            </p>

            <!-- RUT -->
            <p><strong>RUT:</strong> {{ venta.rut }}</p>

            <!-- Teléfono con icono -->
            <p><strong>📞 Teléfono:</strong> {{ venta.telefono }}</p>

            <!-- BOTONES DE ESTADO -->
            <ion-button expand="block"
                        [color]="esEstadoActivo(venta.estado, 'Paquete dentro de centro de distribución') ? 'success' : 'medium'"
                        (click)="actualizarEstado(venta, 'Paquete dentro de centro de distribución')">
              Paquete dentro de centro de distribución
              <img *ngIf="esEstadoActivo(venta.estado, 'Paquete dentro de centro de distribución')" 
                   src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/White_check.svg/2048px-White_check.svg.png"
                   alt="Check" 
                   style="width: 16px; height: 16px; margin-left: 8px;" />
            </ion-button>

            <ion-button expand="block"
                        [color]="esEstadoActivo(venta.estado, 'Paquete en camino') ? 'success' : 'medium'"
                        (click)="actualizarEstado(venta, 'Paquete en camino')">
              Paquete en camino
              <img *ngIf="esEstadoActivo(venta.estado, 'Paquete en camino')" 
                   src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/White_check.svg/2048px-White_check.svg.png"
                   alt="Check" 
                   style="width: 16px; height: 16px; margin-left: 8px;" />
            </ion-button>

            <ion-button expand="block"
                        [color]="esEstadoActivo(venta.estado, 'Paquete llega en 3 minutos') ? 'success' : 'medium'"
                        (click)="actualizarEstado(venta, 'Paquete llega en 3 minutos')">
              Paquete llega en 3 minutos
              <img *ngIf="esEstadoActivo(venta.estado, 'Paquete llega en 3 minutos')" 
                   src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/White_check.svg/2048px-White_check.svg.png"
                   alt="Check" 
                   style="width: 16px; height: 16px; margin-left: 8px;" />
            </ion-button>

            <ion-button expand="block"
                        [color]="esEstadoActivo(venta.estado, 'Fue entregado exitosamente') ? 'success' : 'medium'"
                        (click)="actualizarEstado(venta, 'Fue entregado exitosamente')">
              Fue entregado exitosamente
              <img *ngIf="esEstadoActivo(venta.estado, 'Fue entregado exitosamente')" 
                   src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/White_check.svg/2048px-White_check.svg.png"
                   alt="Check" 
                   style="width: 16px; height: 16px; margin-left: 8px;" />
            </ion-button>

          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
